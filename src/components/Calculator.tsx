import React, { useState } from 'react';

/**
 * Компонент `Calculator`
 *
 * Проста реалізація калькулятора на React з одним дисплеєм та
 * набором кнопок для базових арифметичних операцій.
 *
 * Компонент підтримує:
 * - введення чисел
 * - виконання операцій +, -, *, /
 * - обчислення виразу через кнопку "=" (використовуючи `eval`)
 * - очищення дисплея ("C")
 *
 * @remarks
 * ❗ **Важливо:** використання `eval` може бути небезпечним.
 * Поточна реалізація очікує лише ввод кнопок калькулятора,
 * однак у реальних застосунках рекомендовано використовувати власний парсер.
 *
 * @returns JSX-елемент інтерфейсу калькулятора.
 */
export const Calculator: React.FC = () => {
    /**
     * Поточне значення, що відображається на дисплеї калькулятора.
     * Зберігається як рядок для зручності конкатенації.
     */
    const [display, setDisplay] = useState('0');

    /**
     * Обробляє натискання кнопок калькулятора.
     *
     * @param value Значення кнопки, яку було натиснуто.
     *
     * @remarks
     * Логіка:
     * - "C" — скидає дисплей до "0"
     * - "=" — обчислює вираз через eval
     * - інші символи — додаються до рядка виразу
     */
    const handleClick = (value: string) => {
        if (value === 'C') {
            setDisplay('0');
        } else if (value === '=') {
            try {
                // eslint-disable-next-line no-eval
                setDisplay(String(eval(display)));
            } catch {
                setDisplay('Error');
            }
        } else {
            setDisplay((prev) => (prev === '0' ? value : prev + value));
        }
    };

    /** Список кнопок, що рендеряться у калькуляторі. */
    const buttons = [
        '7', '8', '9', '/',
        '4', '5', '6', '*',
        '1', '2', '3', '-',
        '0', 'C', '=', '+'
    ];

    return (
        <div>
            {/* Дисплей калькулятора */}
            <div data-testid="display">{display}</div>

            {/* Панель кнопок */}
            <div>
                {buttons.map((btn) => (
                    <button key={btn} onClick={() => handleClick(btn)}>
                        {btn}
                    </button>
                ))}
            </div>
        </div>
    );
};
